<%- include("../partials/header") %>

    <div class="container mt-5">
        <div class="text-center mb-4">
            <h2>üìã Open Animal Reports</h2>
        </div>

        <% if (reports.length===0) { %>
            <div class="alert alert-info text-center">
                No open reports found.
            </div>
            <% } else { %>
                <div class="table-responsive shadow-sm">
                    <table class="table table-bordered table-hover align-middle text-center">
                        <thead class="table-light">
                            <tr>
                                <th>Image</th>
                                <th>Description</th>
                                <th>Location (Map)</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% reports.forEach(r=> { %>
                                <tr>
                                    <!-- Animal Image -->
                                    <td>
                                        <img src="<%= r.photoUrl %>" class="img-thumbnail rounded"
                                            style="width: 120px; height: auto;" alt="Animal Photo">
                                    </td>

                                    <!-- Description -->
                                    <td class="text-start">
                                        <%= r.description || "No description" %>
                                    </td>

                                    <!-- Embedded OpenStreetMap -->
                                    <td style="width: 250px;">
                                        <div class="ratio ratio-4x3 rounded overflow-hidden border">
                                            <iframe loading="lazy" allowfullscreen style="border:0"
                                                src="https://www.openstreetmap.org/export/embed.html?bbox=<%= r.location.coordinates[0] - 0.001 %>,<%= r.location.coordinates[1] - 0.001 %>,<%= r.location.coordinates[0] + 0.001 %>,<%= r.location.coordinates[1] + 0.001 %>&layer=mapnik&marker=<%= r.location.coordinates[1] %>,<%= r.location.coordinates[0] %>">
                                            </iframe>
                                        </div>
                                    </td>

                                    <!-- Action Buttons -->
                                    <td>
                                        <a href="/report/<%= r._id %>" class="btn btn-outline-info btn-sm mb-2 w-100">üîç
                                            View</a>
                                        <a href="/ngo/treat/<%= r._id %>"
                                            class="btn btn-outline-success btn-sm w-100">üíä Treat</a>
                                    </td>
                                </tr>
                                <% }); %>
                        </tbody>
                    </table>
                </div>
                <% } %>
    </div>

    <%- include("../partials/footer") %>